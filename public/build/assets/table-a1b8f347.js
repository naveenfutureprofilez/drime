import{r as f,cY as Te,j as s,o as N,R as Ee,cn as pe,cj as be,co as ze,cp as Me,an as ve,aW as Oe,Y as ne,cZ as Ve,cT as He,c_ as Ke,c$ as Be,ar as se,al as ee,S as We,af as le,d0 as _e,ao as U,bE as ie,bb as ye,$ as we,c9 as ce,bz as fe,aw as Ue,bd as Ge,G as ue,T as R,Z as J,ca as je,a6 as oe,x as qe,y as Ye,D as Xe,z as Ze,A as Je,B as Qe,E as et,H as Ce,aT as tt,a as ke,c5 as Ie,V as De,cg as nt,q as S,X as de,aJ as Pe,aA as st,a0 as Se,bp as G,c6 as ot,C as rt,a2 as at,cx as lt,cV as $e,d1 as it,bx as ct,aG as Fe}from"./main-40e0a36e.js";import{$ as he,E as ut}from"./Edit-babe05be.js";import{I as dt,u as ft,c as ht,h as xt,D as mt,i as xe,A as gt,d as pt,a as bt,F as vt}from"./formatted-number-d46ea765.js";function yt(){let e=f.useRef(new Map),t=f.useCallback((o,r,c,l)=>{let u=l!=null&&l.once?(...d)=>{e.current.delete(c),c(...d)}:c;e.current.set(c,{type:r,eventTarget:o,fn:u,options:l}),o.addEventListener(r,u,l)},[]),n=f.useCallback((o,r,c,l)=>{var u;let d=((u=e.current.get(c))===null||u===void 0?void 0:u.fn)||c;o.removeEventListener(r,d,l),e.current.delete(c)},[]),a=f.useCallback(()=>{e.current.forEach((o,r)=>{n(o.eventTarget,o.type,r,o.options)})},[n]);return f.useEffect(()=>a,[a]),{addGlobalListener:t,removeGlobalListener:n,removeAllGlobalListeners:a}}function wt(e){let{ref:t,onInteractOutside:n,isDisabled:a,onInteractOutsideStart:o}=e,r=f.useRef({isPointerDown:!1,ignoreEmulatedMouseEvents:!1}),c=he(u=>{n&&me(u,t)&&(o&&o(u),r.current.isPointerDown=!0)}),l=he(u=>{n&&n(u)});f.useEffect(()=>{let u=r.current;if(a)return;const d=t.current,i=Te(d);if(typeof PointerEvent<"u"){let h=x=>{u.isPointerDown&&me(x,t)&&l(x),u.isPointerDown=!1};return i.addEventListener("pointerdown",c,!0),i.addEventListener("click",h,!0),()=>{i.removeEventListener("pointerdown",c,!0),i.removeEventListener("click",h,!0)}}},[t,a,c,l])}function me(e,t){if(e.button>0)return!1;if(e.target){const n=e.target.ownerDocument;if(!n||!n.documentElement.contains(e.target)||e.target.closest("[data-react-aria-top-layer]"))return!1}return t.current?!e.composedPath().includes(t.current):!1}function jt({className:e,children:t,size:n,color:a,radius:o,selectable:r,wrap:c=!0,startButton:l}){return s.jsxs("div",{className:N("flex items-center gap-8",c&&"flex-wrap",e),children:[l,f.Children.map(t,u=>{if(f.isValidElement(u))return f.cloneElement(u,{size:n,color:a,selectable:r,radius:o})})]})}function ae(e){return{id:e,name:`${e}`,description:`${e}`}}function Ct(e,t){const n=f.useRef(null),a=pe(t),{displayWith:o=w=>w.name,validateWith:r,children:c,suggestions:l,isLoading:u,inputValue:d,onInputValueChange:i,onItemSelected:h,placeholder:x,onOpenChange:g,chipSize:p="sm",openMenuOnFocus:k=!0,showEmptyMessage:I,value:m,defaultValue:b,onChange:C,valueKey:$,isAsync:A,allowCustomValue:L=!0,showDropdownArrow:E,onChipClick:z,alwaysShowAvatar:P=!1,readOnly:j,...v}=e,B=be({...e,flexibleHeight:!0}),[_,q]=Dt(e),[Y,K]=f.useState(!1),y=s.jsx(We,{isIndeterminate:!0,size:"w-24 h-24","aria-label":"loading..."}),D=E?s.jsx(le,{}):null,{fieldProps:M,inputProps:O}=ze({...v,focusRef:a,endAdornment:u&&Y?y:D});return s.jsx(Me,{fieldClassNames:B,...M,children:s.jsxs(dt,{ref:n,className:N("flex flex-wrap items-center",B.input),onClick:()=>{var w;(w=a.current)==null||w.focus()},children:[s.jsx(kt,{displayChipUsing:o,onChipClick:z,items:_,setItems:q,chipSize:p,alwaysShowAvatar:P,readOnly:j}),s.jsx(It,{size:e.size,showEmptyMessage:I,inputProps:O,inputValue:d,onInputValueChange:i,fieldRef:n,inputRef:a,chips:_,setChips:q,validateWith:r,isLoading:u,suggestions:l,placeholder:x,openMenuOnFocus:k,listboxIsOpen:Y,setListboxIsOpen:K,allowCustomValue:L,readOnly:j,children:c})]})})}function kt({items:e,setItems:t,displayChipUsing:n,chipSize:a,onChipClick:o,alwaysShowAvatar:r,readOnly:c}){const l=ve(),u=f.useCallback(d=>{const i=e.findIndex(x=>x.id===d),h=[...e];return i>-1&&(h.splice(i,1),t(h)),h},[e,t]);return s.jsx(jt,{className:N("max-w-full flex-shrink-0 flex-wrap",a==="xs"?"my-6":"my-8"),size:a,selectable:!0,children:e.map(d=>s.jsx(Oe,{errorMessage:d.errorMessage,adornment:d.image||r?s.jsx(ne,{circle:!0,src:d.image,fallback:"initials",label:d.name}):null,onClick:()=>o==null?void 0:o(d),onRemove:c?void 0:()=>{u(d.id).length?l==null||l.focusPrevious({tabbable:!0}):l==null||l.focusLast()},children:n(d)},d.id))})}function It(e){const{inputRef:t,fieldRef:n,validateWith:a,setChips:o,chips:r,suggestions:c,inputProps:l,placeholder:u,openMenuOnFocus:d,listboxIsOpen:i,setListboxIsOpen:h,allowCustomValue:x,isLoading:g,size:p,readOnly:k}=e,I=ve(),m=f.useCallback(y=>{y=(y||[]).filter(D=>{const M=!D||!D.id||!D.name;return!(r.findIndex(w=>w.id===(D==null?void 0:D.id))>-1)&&!M}),y.length&&(a&&(y=y.map(D=>a(D))),o([...r,...y]))},[r,o,a]),b=Ve({...e,clearInputOnItemSelection:!0,isOpen:i,onOpenChange:h,items:c,selectionMode:"none",role:"listbox",virtualFocus:!0,onItemSelected:y=>{_(y)}}),{state:{activeIndex:C,setActiveIndex:$,isOpen:A,setIsOpen:L,inputValue:E,setInputValue:z},refs:P,listboxId:j,collection:v,onInputChange:B}=b,_=y=>{const D=v.size&&C!=null?[...v.values()][C]:null;D!=null&&D.item?m([D.item]):x&&m([ae(D?D.value:y)]),z(""),$(null),L(!1)};He(()=>{n.current&&P.reference.current!==n.current&&b.reference(n.current)},[n,b,P]);const{handleTriggerKeyDown:q,handleListboxKeyboardNavigation:Y}=_e(b),K=U(()=>{d&&!A&&L(!0)});return s.jsx(Ke,{listbox:b,mobileOverlay:Be,isLoading:g,onPointerDown:y=>{y.preventDefault()},children:s.jsx("input",{readOnly:k,type:"text",className:N("mx-8 my-4 min-w-30 flex-[1_1_60px] bg-transparent text-sm outline-none",p==="xs"?"h-20":"h-30"),placeholder:u,...se(l,{ref:t,value:E,onChange:B,onPaste:y=>{const M=y.clipboardData.getData("text").match(/([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9._-]+)/gi);if(M){y.preventDefault();const O=window.getSelection();O!=null&&O.rangeCount&&(O.deleteFromDocument(),m(M.map(w=>ae(w))))}},"aria-autocomplete":"list","aria-controls":A?j:void 0,autoComplete:"off",autoCorrect:"off",spellCheck:"false",onKeyDown:y=>{if(k)return;const D=y.target;if(y.key==="Enter"){y.preventDefault(),_(D.value);return}if(y.key==="Escape"&&A&&(L(!1),z("")),y.key==="ArrowUp"&&A&&(C===0||C==null)){$(null);return}if(C!=null&&(y.key==="ArrowLeft"||y.key==="ArrowRight")){y.preventDefault();return}if((y.key==="ArrowLeft"||y.key==="Backspace"||y.key==="Delete")&&D.selectionStart===0&&C==null&&r.length){I==null||I.focusPrevious({tabbable:!0});return}q(y)||Y(y)},onFocus:k?void 0:K,onClick:k?void 0:K})})})}function Dt({onChange:e,value:t,defaultValue:n,valueKey:a}){const o=f.useMemo(()=>ge(t),[t]),r=f.useMemo(()=>ge(n),[n]),c=f.useCallback(l=>{const u=a?l.map(d=>d[a]):l;e==null||e(u)},[e,a]);return ee(o||void 0,r||[],c)}function ge(e){if(e!=null)return e.map(t=>typeof t!="object"?ae(t):t)}const Pt=Ee.forwardRef(Ct),Dn=ie(s.jsx("path",{d:"M16 9v10H8V9h8m-1.5-6h-5l-1 1H5v2h14V4h-3.5l-1-1zM18 7H6v12c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7z"}),"DeleteOutlined"),Pn=ie(s.jsx("path",{d:"M18 15v3H6v-3H4v3c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2v-3h-2zM7 9l1.41 1.41L11 7.83V16h2V7.83l2.59 2.58L17 9l-5-5-5 5z"}),"FileUploadOutlined");function Sn(e){return"next_cursor"in e?e.next_cursor!=null:"last_page"in e?e.current_page<e.last_page:"next_page"in e?e.next_page!=null:e.data.length>0&&e.data.length>=e.per_page}let W=function(e){return e.Select="select",e.DateRangePicker="dateRangePicker",e.SelectModel="selectModel",e.Input="input",e.BooleanToggle="booleanToggle",e.ChipField="chipField",e.Custom="custom",e}({}),F=function(e){return e.eq="=",e.ne="!=",e.gt=">",e.gte=">=",e.lt="<",e.lte="<=",e.has="has",e.notNull="notNull",e.contains="contains",e.notContains="notContains",e.startsWith="startsWith",e.endsWith="endsWith",e.hasAll="hasAll",e.doesntHave="doesntHave",e.between="between",e}({});F.eq,F.ne,F.contains,F.notContains,F.startsWith,F.endsWith,F.notNull;F.eq,F.ne,F.gt,F.gte,F.lt,F.lte,F.notNull;function St(e){var x,g;const{granularity:t,closeDialogOnSelection:n,...a}=e,o=ft(e),r=f.useRef(null),l=ye()&&t!=="day",u=s.jsx(we,{offset:8,placement:"bottom-start",isOpen:o.calendarIsOpen,onOpenChange:o.setCalendarIsOpen,type:"popover",triggerRef:r,returnFocusToTrigger:!1,moveFocusToDialog:!1,children:s.jsx(ht,{state:o})}),d={onClick:p=>{p.stopPropagation(),p.preventDefault(),$t(p)?o.setCalendarIsOpen(!1):o.setCalendarIsOpen(!0)}},i=o.selectedValue,h=o.setSelectedValue;return s.jsxs(f.Fragment,{children:[s.jsxs(xt,{ref:r,wrapperProps:d,endAdornment:l?void 0:s.jsx(mt,{}),...a,children:[s.jsx(xe,{isPlaceholder:(x=o.isPlaceholder)==null?void 0:x.start,state:o,segmentProps:d,value:i.start,onChange:p=>{h({start:p,end:i.end})}}),s.jsx(gt,{className:"block flex-shrink-0 text-muted",size:"md"}),s.jsx(xe,{isPlaceholder:(g=o.isPlaceholder)==null?void 0:g.end,state:o,segmentProps:d,value:i.end,onChange:p=>{h({start:i.start,end:p})}})]}),u]})}function $t(e){return["hour","minute","dayPeriod"].includes(e.currentTarget.ariaLabel||"")}function Ft(e){const{field:{onChange:t,onBlur:n,value:a,ref:o},fieldState:{invalid:r,error:c}}=ce({name:e.name}),l={onChange:u=>{t(u?Rt(u):null)},onBlur:n,value:Nt(a),invalid:r,errorMessage:c==null?void 0:c.message,inputRef:o};return s.jsx(St,{...se(l,e)})}function Nt(e){const{start:t,end:n,preset:a}=e||{},o={preset:a};try{t&&(o.start=typeof t=="string"?fe(t):t),n&&(o.end=typeof n=="string"?fe(n):n)}catch{}return o}function Rt({start:e,end:t,preset:n}={}){const a={preset:n};return e&&(a.start=e.toAbsoluteString()),t&&(a.end=t.toAbsoluteString()),a}const re="filters";function At(e){if(!e)return[];let t=[];try{t=JSON.parse(atob(decodeURIComponent(e))),t.map(n=>(n.valueKey!=null&&(n.value=n.valueKey),n))}catch{}return t}function Lt(e,t){return!e||(e=t?e.filter(n=>n.value!=="").map(n=>Tt(n,t)):e,e=e.filter(n=>!n.isInactive),!e.length)?"":encodeURIComponent(btoa(JSON.stringify(e)))}function Tt(e,t){var a;const n=t.find(o=>o.key===e.key);if((n==null?void 0:n.control.type)==="select"){const o=(n.control.options||[]).find(r=>r.key===e.value);if(o)return{...e,value:o.value,valueKey:o.key}}return(a=n==null?void 0:n.extraFilters)!=null&&a.length&&(e.extraFilters=n.extraFilters),e}function Et(e,t){const[n]=Ue(),a=Ge(),o=n.get(re),r=f.useMemo(()=>{if(!e)return[];const i=At(o);return(t||[]).forEach(h=>{if(!i.find(x=>x.key===h)){const x=e.find(g=>g.key===h);i.push({key:h,value:x.control.defaultValue,operator:x.defaultOperator,isInactive:!0})}}),i.sort((h,x)=>e.findIndex(g=>g.key===h.key)-e.findIndex(g=>g.key===x.key)),i},[o,t,e]),c=f.useCallback(i=>{const h=[...r];return i.forEach(x=>{const g=typeof x=="object"?x.key:x,p=h.findIndex(k=>k.key===g);p>-1&&h.splice(p,1)}),h},[r]),l=f.useCallback(i=>{const h=Lt(i,e);h?n.set(re,h):n.delete(re),a({search:`?${n}`},{replace:!0})},[e,a,n]),u=f.useCallback(i=>{const x=[...c(i),...i];l(x)},[c,l]),d=f.useCallback(i=>l(c([i])),[c,l]);return{add:u,remove:d,replaceAll:l,decodedFilters:r,encodedFilters:o}}const Ne=f.forwardRef((e,t)=>{const{isInactive:n,filter:a,...o}=e;return n?s.jsx(zt,{filter:a,...o,ref:t}):s.jsx(Mt,{filter:a,...o,ref:t})}),zt=f.forwardRef(({filter:e,...t},n)=>s.jsx(ue,{variant:"outline",size:"xs",color:"paper",radius:"rounded-md",border:"border",ref:n,endIcon:s.jsx(le,{}),...t,children:s.jsx(R,{...e.label})})),Mt=f.forwardRef(({filter:e,children:t,...n},a)=>{const o=e.control.type===W.BooleanToggle;return s.jsxs(ue,{variant:"outline",size:"xs",color:"primary",radius:"rounded-r-md",border:"border-y border-r",endIcon:!o&&s.jsx(le,{}),ref:a,...n,children:[s.jsx("span",{className:N(!o&&"mr-8 border-r border-r-primary-light pr-8"),children:s.jsx(R,{...e.label})}),t]})});function Ot({filter:e}){const{trans:t}=J();return s.jsx(je,{size:"sm",name:`${e.key}.value`,selectionMode:"single",showSearchField:e.control.showSearchField,placeholder:e.control.placeholder?t(e.control.placeholder):void 0,searchPlaceholder:e.control.searchPlaceholder?t(e.control.searchPlaceholder):void 0,children:e.control.options.map(n=>s.jsx(oe,{value:n.key,children:typeof n.label=="string"?n.label:s.jsx(R,{...n.label})},n.key))})}function Q(e){const{onValueChange:t,isInactive:n,filter:a,label:o}=e;return s.jsxs(we,{offset:10,type:"popover",onClose:r=>{r!==void 0&&t(r)},children:[s.jsx(Ne,{isInactive:n,filter:a,children:o}),s.jsx(Vt,{...e})]})}function Vt({filter:e,panel:t,value:n,operator:a}){const o=qe({defaultValues:{[e.key]:{value:n,operator:a}}}),{close:r,formId:c}=Ye();return s.jsxs(Xe,{size:"xs",children:[s.jsx(Ze,{children:s.jsx(R,{...e.label})}),s.jsx(Je,{padding:"px-14 pt-14 pb-4 max-h-288",children:s.jsxs(Qe,{form:o,id:c,onSubmit:l=>{r(l[e.key])},children:[e.description&&s.jsx("div",{className:"mb-14 text-xs text-muted",children:s.jsx(R,{...e.description})}),t]})}),s.jsx(et,{children:s.jsx(ue,{form:c,type:"submit",variant:"flat",color:"primary",size:"xs",children:s.jsx(R,{message:"Apply"})})})]})}function Ht(e,t,n){return Ce({queryKey:[...e.split("/"),t],queryFn:()=>Kt(e,t),placeholderData:tt,...n})}async function Kt(e,t){return ke.get(e,{params:t}).then(n=>"results"in n.data?n.data:{results:Object.values(n.data).find(o=>Array.isArray(o))})}function Re(e,t,n){return Ce({queryKey:[e,t],queryFn:()=>Bt(e,t),...n})}async function Bt(e,t){return ke.get(e,{params:t}).then(n=>n.data)}function Wt({label:e,className:t,background:n,value:a,defaultValue:o="",placeholder:r=S("Select item..."),searchPlaceholder:c=S("Find an item..."),onChange:l,description:u,errorMessage:d,invalid:i,autoFocus:h,queryParams:x,endpoint:g,disabled:p,required:k}){var z;const I=f.useRef(null),[m,b]=f.useState(""),[C,$]=ee(a,o,l),A=Ht(g,{query:m,...x}),{trans:L}=J(),E=be({size:"md"});return C?s.jsxs("div",{className:t,children:[s.jsx("div",{className:E.label,children:e}),s.jsx("div",{className:N("rounded-input border p-8",n,i&&"border-danger"),children:s.jsx(De,{initial:!1,mode:"wait",children:s.jsx(_t,{disabled:p,endpoint:g,modelId:C,queryParams:x,onEditClick:()=>{$(""),b(""),requestAnimationFrame(()=>{var P,j;(P=I.current)==null||P.focus(),(j=I.current)==null||j.click()})}})})}),u&&!d&&s.jsx("div",{className:E.description,children:u}),d&&s.jsx("div",{className:E.error,children:d})]}):s.jsx(nt,{className:t,showSearchField:!0,invalid:i,errorMessage:d,description:u,color:"white",isAsync:!0,background:n,placeholder:L(r),searchPlaceholder:L(c),label:e,isLoading:A.isFetching,items:(z=A.data)==null?void 0:z.results,inputValue:m,onInputValueChange:b,selectionMode:"single",selectedValue:C,onSelectionChange:$,ref:I,autoFocus:h,disabled:p,required:k,children:P=>s.jsx(oe,{value:P.id,description:P.description,startIcon:s.jsx(ne,{src:P.image,size:"sm",label:P.name}),children:P.name},P.id)})}function _t({modelId:e,onEditClick:t,endpoint:n,disabled:a,queryParams:o}){const{data:r,isLoading:c}=Re(`${n}/${e}`,o);return c||!(r!=null&&r.model)?s.jsx(Ut,{},"skeleton"):s.jsxs(de.div,{className:N("flex items-center gap-10",a&&"pointer-events-none cursor-not-allowed text-disabled"),...Pe,children:[s.jsx(ne,{src:r.model.image,label:r.model.name}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm leading-4",children:r.model.name}),s.jsx("div",{className:"text-xs text-muted",children:r.model.description})]}),s.jsx(st,{label:s.jsx(R,{message:"Change item"}),children:s.jsx(Se,{className:"ml-auto text-muted",size:"sm",onClick:t,disabled:a,children:s.jsx(ut,{})})})]},"preview")}function Ut(){return s.jsxs(de.div,{className:"flex items-center gap-10",...Pe,children:[s.jsx(G,{variant:"rect",size:"w-32 h-32"}),s.jsxs("div",{className:"max-h-[36px] flex-auto",children:[s.jsx(G,{className:"text-xs"}),s.jsx(G,{className:"max-h-8 text-xs"})]}),s.jsx(G,{variant:"icon",size:"w-24 h-24"})]})}function Gt({name:e,...t}){const{clearErrors:n}=Ie(),{field:{onChange:a,value:o=""},fieldState:{invalid:r,error:c}}=ce({name:e});return s.jsx(Wt,{value:o,onChange:l=>{a(l),n(e)},invalid:r,errorMessage:c==null?void 0:c.message,...t})}function qt({filter:e}){return s.jsx(Gt,{name:`${e.key}.value`,endpoint:e.control.endpoint?e.control.endpoint:`normalized-models/${e.control.model}`})}function Yt({filter:e}){return s.jsx(Ft,{min:e.control.min,max:e.control.max,size:"sm",name:`${e.key}.value`,granularity:"day",closeDialogOnSelection:!0})}const Ae={"=":S("is"),"!=":S("is not"),">":S("is greater than"),">=":S("is greater than or equal to"),"<":S("is less than"),"<=":S("is less than or equal to"),notNull:S("has any value"),contains:S("contains"),notContains:S("does not contain"),startsWith:S("starts with"),endsWith:S("ends with"),has:S("Include"),doesntHave:S("Do not include"),between:S("Is between"),hasAll:S("Include all")};function Xt({filter:e}){var o,r;const t=e.control,n=Ie(),a=ot({control:n.control,name:`${e.key}.operator`});return s.jsxs(f.Fragment,{children:[(o=e.operators)!=null&&o.length?s.jsx(je,{selectionMode:"single",name:`${e.key}.operator`,className:"mb-14",size:"sm",children:(r=e.operators)==null?void 0:r.map(c=>s.jsx(oe,{value:c,children:s.jsx(R,{...Ae[c]})},c))}):null,a==="notNull"?null:s.jsx(rt,{size:"sm",name:`${e.key}.value`,type:e.control.inputType,min:"minValue"in t?t.minValue:void 0,max:"maxValue"in t?t.maxValue:void 0,minLength:"minLength"in t?t.minLength:void 0,maxLength:"maxLength"in t?t.maxLength:void 0})]})}function Zt({children:e,...t}){const{field:{onChange:n,onBlur:a,value:o=[],ref:r},fieldState:{invalid:c,error:l}}=ce({name:t.name}),u={onChange:n,onBlur:a,value:o,invalid:c,errorMessage:l==null?void 0:l.message};return s.jsx(Pt,{ref:r,...se(u,t),children:e})}function Jt({filter:e}){const{trans:t}=J();return s.jsx(Zt,{size:"sm",name:`${e.key}.value`,valueKey:"id",allowCustomValue:!1,showDropdownArrow:!0,placeholder:e.control.placeholder?t(e.control.placeholder):void 0,displayWith:n=>{const a=e.control.options.find(o=>o.key===n.id);if(a)return typeof a.label=="string"?a.label:a.label.message},suggestions:e.control.options.map(n=>({id:n.key,name:typeof n.label=="string"?n.label:n.label.message})),children:n=>s.jsx(oe,{value:n.id,children:s.jsx(R,{message:n.name})},n.id)})}function Qt(e){switch(e.filter.control.type){case W.DateRangePicker:return s.jsx(en,{...e});case W.BooleanToggle:return s.jsx(tn,{...e});case W.Select:return s.jsx(nn,{...e});case W.ChipField:return s.jsx(sn,{...e});case W.Input:return s.jsx(rn,{...e});case W.SelectModel:return s.jsx(an,{...e});case W.Custom:const t=e.filter.control.listItem;return s.jsx(t,{...e});default:return null}}function en(e){const{value:t,filter:n}=e;let a;return t.preset!==void 0?a=s.jsx(R,{...pt[t.preset].label}):a=s.jsx(bt,{start:new Date(t.start),end:new Date(t.end),options:{dateStyle:"medium"}}),s.jsx(Q,{...e,label:a,panel:s.jsx(Yt,{filter:n})})}function tn({filter:e,isInactive:t,onValueChange:n}){return s.jsx(Ne,{onClick:()=>{n({value:e.control.defaultValue})},filter:e,isInactive:t})}function nn(e){const{filter:t,value:n}=e,a=t.control.options.find(o=>o.key===n);return s.jsx(Q,{...e,label:a?typeof a.label=="string"?a.label:s.jsx(R,{...a.label}):null,panel:s.jsx(Ot,{filter:t})})}function sn(e){return s.jsx(Q,{...e,label:s.jsx(on,{...e}),panel:s.jsx(Jt,{filter:e.filter})})}function on(e){const{trans:t}=J(),{filter:n,value:a}=e,o=a.map(u=>n.control.options.find(d=>d.key===u)),r=3,c=a.length-r,l=s.jsx(f.Fragment,{children:o.filter(Boolean).slice(0,r).map((u,d)=>{let i="";return d!==0&&(i+=", "),i+=typeof u.label=="string"?u.label:t(u.label),i})});return c>0?s.jsx(R,{message:":names + :count more",values:{names:l,count:c}}):l}function rn(e){const{filter:t,value:n,operator:a}=e,o=a?s.jsx(R,{...Ae[a]}):null,r=t.control.inputType==="number"?s.jsx(vt,{value:n}):n;return s.jsx(Q,{...e,label:s.jsxs(f.Fragment,{children:[o," ",r]}),panel:s.jsx(Xt,{filter:t})})}function an(e){const{value:t,filter:n}=e,{isLoading:a,data:o}=Re(n.control.endpoint?`${n.control.endpoint}/${t}`:`normalized-models/${n.control.model}/${t}`,void 0,{enabled:!!t}),r=s.jsxs(f.Fragment,{children:[s.jsx(G,{variant:"avatar",size:"w-18 h-18 mr-6"}),s.jsx(G,{variant:"rect",size:"w-50"})]}),c=s.jsxs(f.Fragment,{children:[s.jsx(ne,{size:"xs",src:o==null?void 0:o.model.image,label:o==null?void 0:o.model.name,className:"mr-6"}),o==null?void 0:o.model.name]}),l=a||!o?r:c;return s.jsx(Q,{...e,label:l,panel:s.jsx(qt,{filter:n})})}function $n({filters:e,pinnedFilters:t,className:n,wrap:a}){const{decodedFilters:o,remove:r,replaceAll:c}=Et(e,t);return o.length?s.jsx("div",{className:N("flex items-center gap-6",n,a?"flex-wrap":"overflow-x-auto"),children:o.map((l,u)=>{const d=e.find(h=>h.key===l.key);if(!d)return null;const i=h=>{const x=[...o];x.splice(u,1,{key:d.key,value:h.value,isInactive:!1,operator:h.operator||d.defaultOperator}),c(x)};return s.jsxs("div",{children:[!l.isInactive&&s.jsx(Se,{variant:"outline",color:"primary",size:"xs",radius:"rounded-l-md",onClick:()=>{r(l.key)},children:s.jsx(at,{})}),s.jsx(Qt,{filter:d,isInactive:l.isInactive,value:l.valueKey!=null?l.valueKey:l.value,operator:l.operator,onValueChange:i})]},l.key)})}):null}function ln({onMoveStart:e,onMove:t,onMoveEnd:n,minimumMovement:a=0,preventDefault:o,stopPropagation:r=!0,onPress:c,onLongPress:l,...u}){const i=f.useRef({lastPosition:{x:0,y:0},started:!1,longPressTriggered:!1}).current,{addGlobalListener:h,removeGlobalListener:x}=yt(),g=m=>{!i.el||(e==null?void 0:e(m,i.el))===!1||(i.originalTouchAction=i.el.style.touchAction,i.el.style.touchAction="none",i.originalUserSelect=document.documentElement.style.userSelect,document.documentElement.style.userSelect="none",i.started=!0)},p=m=>{var b;if(m.button===0&&i.id==null){if(i.started=!1,((b=u.onPointerDown)==null?void 0:b.call(u,m))===!1)return;r&&m.stopPropagation(),o&&m.preventDefault(),i.id=m.pointerId,i.el=m.currentTarget,i.lastPosition={x:m.clientX,y:m.clientY},l&&(i.longPressTimer=setTimeout(()=>{l(m,i.el),i.longPressTriggered=!0},400)),(e||t)&&h(window,"pointermove",k,!1),h(window,"pointerup",I,!1),h(window,"pointercancel",I,!1)}},k=m=>{if(m.pointerId===i.id){const b=m.clientX-i.lastPosition.x,C=m.clientY-i.lastPosition.y;(Math.abs(b)>=a||Math.abs(C)>=a)&&!i.started&&g(m),i.started&&(t==null||t(m,b,C),i.lastPosition={x:m.clientX,y:m.clientY})}},I=m=>{var b;if(m.pointerId===i.id){i.longPressTimer&&clearTimeout(i.longPressTimer);const C=i.longPressTriggered;i.longPressTriggered=!1,i.started&&(n==null||n(m)),i.el&&(m.type!=="pointercancel"&&((b=u.onPointerUp)==null||b.call(u,m,i.el),m.target&&i.el.contains(m.target)&&(C?l==null||l(m,i.el):c==null||c(m,i.el))),document.documentElement.style.userSelect=i.originalUserSelect||"",i.el.style.touchAction=i.originalTouchAction||""),i.id=void 0,i.started=!1,x(window,"pointermove",k,!1),x(window,"pointerup",I,!1),x(window,"pointercancel",I,!1)}};return{domProps:{onPointerDown:U(p)}}}function te(e){return lt()?e.metaKey:e.ctrlKey}function cn(e){const{cellCount:t,rowCount:n}=e;return{onKeyDown:o=>{switch(o.key){case"ArrowLeft":V(o,{cell:{op:"decrement"}},e);break;case"ArrowRight":V(o,{cell:{op:"increment"}},e);break;case"ArrowUp":V(o,{row:{op:"decrement"}},e);break;case"ArrowDown":V(o,{row:{op:"increment"}},e);break;case"PageUp":V(o,{row:{op:"decrement",count:5}},e);break;case"PageDown":V(o,{row:{op:"increment",count:5}},e);break;case"Tab":un(o);break;case"Home":te(o)?V(o,{row:{op:"decrement",count:n},cell:{op:"decrement",count:t}},e):V(o,{cell:{op:"decrement",count:t}},e);break;case"End":te(o)?V(o,{row:{op:"increment",count:n},cell:{op:"increment",count:t}},e):V(o,{cell:{op:"increment",count:t}},e);break}}}}function V(e,t,{cellCount:n,rowCount:a}){var p,k,I,m,b,C,$;if(((p=document.activeElement)==null?void 0:p.tagName)==="input")return;e.preventDefault();const o=e.currentTarget,r=e.target.closest("[aria-colindex]");if(!r||!o)return;const c=r.closest("[aria-rowindex]");if(!c)return;let l=parseInt(c.getAttribute("aria-rowindex")),u=parseInt(r.getAttribute("aria-colindex"));if(Number.isNaN(l)||Number.isNaN(u))return;const d=((k=t.row)==null?void 0:k.count)??1;((I=t.row)==null?void 0:I.op)==="increment"?l=Math.min(a,l+d):((m=t.row)==null?void 0:m.op)==="decrement"&&(l=Math.max(1,l-d));const i=((b=t.cell)==null?void 0:b.count)??1;((C=t.cell)==null?void 0:C.op)==="increment"?u=Math.min(n,u+i):(($=t.cell)==null?void 0:$.op)==="decrement"&&(u=Math.max(1,u-i));const h=o.querySelector(`[aria-rowindex="${l}"] [aria-colindex="${u}"]`);if(!h)return;const g=$e(h).nextNode()||h;r.setAttribute("tabindex","-1"),g.setAttribute("tabindex","0"),g.focus()}function un(e){const t=e.currentTarget;if(e.shiftKey)t.focus();else{const n=$e(t,{tabbable:!0});let a,o;do o=n.lastChild(),o&&(a=o);while(o);a&&!a.contains(document.activeElement)&&it(a)}}const H=f.createContext(null);function Le({index:e,isHeader:t}){const{columns:n,cellHeight:a="h-32",headerCellHeight:o="h-32"}=f.useContext(H),r=n[e],c=r==null?void 0:r.padding;let l="justify-start";return(r==null?void 0:r.align)==="center"?l="justify-center":(r==null?void 0:r.align)==="end"&&(l="justify-end"),N("flex items-center whitespace-nowrap overflow-ellipsis outline-none focus-visible:outline focus-visible:outline-offset-2",t?o:a,(r==null?void 0:r.width)??"flex-1",r==null?void 0:r.maxWidth,r==null?void 0:r.minWidth,l,c,r==null?void 0:r.className)}function dn({rowIndex:e,rowIsHovered:t,index:n,item:a,id:o}){const{columns:r}=f.useContext(H),c=r[n],l=f.useMemo(()=>({index:e,isHovered:t,isPlaceholder:a.isPlaceholder}),[e,t,a.isPlaceholder]),u=Le({index:n,isHeader:!1});return s.jsx("div",{tabIndex:-1,role:"gridcell","aria-colindex":n+1,id:o,className:u,children:s.jsx("div",{className:"w-full overflow-hidden overflow-ellipsis",children:c.body(a,l)})})}function fn(e){return e.shiftKey||te(e)}function hn({index:e,isSelected:t,isHeader:n}){const a=ct(),o=ye(),{hideBorder:r,enableSelection:c,collapseOnMobile:l,onAction:u}=f.useContext(H);return N("flex text-center justify-center items-center gap-x-4 break-inside-avoid outline-none border border-transparent",u&&"cursor-pointer",o&&l&&r?"mb-8 pl-8 pr-0 rounded":"px-8",!r&&"border-b-divider",!r&&e===0&&"border-t-divider",t&&!a&&"bg-primary/selected hover:bg-primary/focus focus-visible:bg-primary/focus",t&&a&&"bg-selected hover:bg-focus focus-visible:bg-focus",!t&&!n&&(c||u)&&"focus-visible:bg-focus hover:bg-hover")}const xn=["button","a","input","select","textarea"];function mn({item:e,index:t,renderAs:n,className:a,style:o}){const{selectedRows:r,columns:c,toggleRow:l,selectRow:u,onAction:d,selectRowOnContextMenu:i,enableSelection:h,selectionStyle:x,hideHeaderRow:g}=f.useContext(H),p=f.useRef(!1),k=r.includes(e.id),[I,m]=f.useState(!1),b=v=>v.target.closest(xn.join(",")),C=v=>{x==="highlight"&&d&&!p.current&&!b(v)&&(v.preventDefault(),v.stopPropagation(),d(e,t))},$=!!r.length,A=v=>{b(v)||(x==="checkbox"?h&&($||!d)?l(e):d&&d(e,t):x==="highlight"&&(p.current?h&&$?l(e):d==null||d(e,t):h&&u(e,fn(v))))},{domProps:L}=ln({onPointerDown:v=>{p.current=v.pointerType==="touch"},onPress:A,onLongPress:h?()=>{p.current&&l(e)}:void 0}),E=v=>{h&&v.key===" "?(v.preventDefault(),v.stopPropagation(),x==="checkbox"?l(e):u(e)):v.key==="Enter"&&!r.length&&d&&(v.preventDefault(),v.stopPropagation(),d(e,t))},z=v=>{i&&h&&(r.includes(e.id)||u(e)),p.current&&(v.preventDefault(),v.stopPropagation())},P=hn({index:t,isSelected:k}),j=n||"div";return s.jsx(j,{role:"row","aria-rowindex":t+1+(g?0:1),"aria-selected":k,tabIndex:-1,className:N(a,P),item:j==="div"?void 0:e,onDoubleClick:U(C),onKeyDown:U(E),onContextMenu:U(z),onPointerEnter:U(()=>m(!0)),onPointerLeave:U(()=>m(!1)),style:o,...L,children:c.map((v,B)=>s.jsx(dn,{rowIndex:t,rowIsHovered:I,index:B,item:e},`${e.id}-${v.key}`))})}const gn={key:"checkbox",header:()=>s.jsx(bn,{}),align:"center",width:"w-24 flex-shrink-0",body:(e,t)=>t.isPlaceholder?s.jsx(G,{size:"w-24 h-24",variant:"rect"}):s.jsx(pn,{item:e})};function pn({item:e}){const{selectedRows:t,toggleRow:n}=f.useContext(H);return s.jsx(Fe,{checked:t.includes(e.id),onChange:()=>n(e)})}function bn(){const{trans:e}=J(),{data:t,selectedRows:n,onSelectionChange:a}=f.useContext(H),o=!!t.length&&t.length===n.length,r=!o&&!!n.length;return s.jsx(Fe,{"aria-label":e({message:"Select all"}),isIndeterminate:r,checked:o,onChange:()=>{a(o?[]:t.map(c=>c.id))}})}const vn=ie(s.jsx("path",{d:"m20 12-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8 8-8z"}),"ArrowDownwardOutlined");function yn({index:e}){const{columns:t,sortDescriptor:n,onSortChange:a,enableSorting:o}=f.useContext(H),r=t[e],c=Le({index:e,isHeader:!0}),[l,u]=f.useState(!1),d=r.sortingKey||r.key,i=r.allowsSorting&&o,{orderBy:h,orderDir:x}=n||{},g=i&&h===d;let p;g&&x==="asc"?p="ascending":g&&x==="desc"?p="descending":i&&(p="none");const k=()=>{if(!i)return;let b;g&&x==="desc"?b={orderDir:"asc",orderBy:d}:g&&x==="asc"?b={orderBy:void 0,orderDir:void 0}:b={orderDir:"desc",orderBy:d},a==null||a(b)},I=g||l,m={visible:{opacity:1,y:0},hidden:{opacity:0,y:"-25%"}};return s.jsxs("div",{role:"columnheader",tabIndex:-1,"aria-colindex":e+1,"aria-sort":p,className:N(c,"text-xs font-medium text-muted",i&&"cursor-pointer"),onMouseEnter:()=>{u(!0)},onMouseLeave:()=>{u(!1)},onKeyDown:b=>{(b.key===" "||b.key==="Enter")&&(b.preventDefault(),k())},onClick:k,children:[r.hideHeader?s.jsx("div",{className:"opacity-0",children:r.header()}):r.header(),s.jsx(De,{children:i&&s.jsx(de.span,{variants:m,animate:I?"visible":"hidden",initial:!1,transition:{type:"tween"},className:"-mt-2 ml-6 inline-block","data-testid":"table-sort-button","aria-hidden":!I,children:s.jsx(vn,{size:"xs",className:N("text-muted",x==="asc"&&h===d&&"rotate-180 transition-transform")})},"sort-icon")})]})}function wn(){const{columns:e}=f.useContext(H);return s.jsx("div",{role:"row","aria-rowindex":1,tabIndex:-1,className:"flex gap-x-4 px-0",children:e.map((t,n)=>s.jsx(yn,{index:n},t.key))})}function Fn({className:e,columns:t,collapseOnMobile:n=!0,hideHeaderRow:a=!1,hideBorder:o=!1,data:r,selectedRows:c,defaultSelectedRows:l,onSelectionChange:u,sortDescriptor:d,onSortChange:i,enableSorting:h=!0,onDelete:x,enableSelection:g=!0,selectionStyle:p="checkbox",ariaLabelledBy:k,selectRowOnContextMenu:I,onAction:m,renderRowAs:b,tableBody:C,meta:$,tableRef:A,closeOnInteractOutside:L=!1,cellHeight:E,headerCellHeight:z,...P}){const[j,v]=ee(c,l||[],u),[B,_]=ee(d,void 0,i),q=f.useCallback(w=>{const T=[...j];if(!T.includes(w.id))T.push(w.id);else{const X=T.indexOf(w.id);T.splice(X,1)}v(T)},[j,v]),Y=f.useCallback((w,T)=>{let X=[];w&&(X=T?[...j==null?void 0:j.filter(Z=>Z!==w.id),w.id]:[w.id]),v(X)},[j,v]),K=f.useMemo(()=>{const w=(t||[]).filter(X=>{const Z=X.visibleInMode||"regular";if(Z==="all"||Z==="compact"||Z==="regular")return!0});return g&&p!=="highlight"&&w.unshift(gn),w},[t,g,p]),y={cellHeight:E,headerCellHeight:z,hideBorder:o,hideHeaderRow:a,selectedRows:j,onSelectionChange:v,enableSorting:h,enableSelection:g,selectionStyle:p,data:r,columns:K,sortDescriptor:B,onSortChange:_,toggleRow:q,selectRow:Y,onAction:m,selectRowOnContextMenu:I,meta:$,collapseOnMobile:n},D=cn({cellCount:g?K.length+1:K.length,rowCount:(r||[]).length+1}),M={renderRowAs:b};C?C=f.cloneElement(C,M):C=s.jsx(jn,{...M});const O=pe(A);return wt({ref:O,onInteractOutside:w=>{L&&g&&(j!=null&&j.length)&&!w.target.closest('[role="dialog"]')&&v([])}}),s.jsx(H.Provider,{value:y,children:s.jsxs("div",{...se(P,D,{onKeyDown:w=>{w.key==="Escape"?(w.preventDefault(),w.stopPropagation(),j!=null&&j.length&&v([])):w.key==="Delete"?(w.preventDefault(),w.stopPropagation(),j!=null&&j.length&&(x==null||x(r.filter(T=>j==null?void 0:j.includes(T.id))))):te(w)&&w.key==="a"&&(w.preventDefault(),w.stopPropagation(),g&&v(r.map(T=>T.id)))}}),role:"grid",tabIndex:0,"aria-rowcount":(r||[]).length+1,"aria-colcount":K.length+1,ref:O,"aria-multiselectable":g?!0:void 0,"aria-labelledby":k,className:N(e,"isolate select-none text-sm outline-none focus-visible:ring-2"),children:[!a&&s.jsx(wn,{}),C]})})}function jn({renderRowAs:e}){const{data:t}=f.useContext(H);return console.log("data",t),s.jsx(f.Fragment,{children:t&&(t==null?void 0:t.map((n,a)=>s.jsx(mn,{item:n,index:a,renderAs:e},n.id)))})}export{yt as $,vn as A,re as B,Pt as C,Dn as D,Pn as F,Xt as I,qt as N,Ot as S,H as T,F as a,W as b,$n as c,Fn as d,te as e,jt as f,Ht as g,Sn as h,fn as i,Lt as j,Zt as k,Gt as l,Rt as m,Et as n,Yt as o,Jt as p,ln as u};
//# sourceMappingURL=table-a1b8f347.js.map
