{"version":3,"file":"guest-download-view-118be6c7.js","sources":["../../images/Vector.png","../../../resources/client/components/Download.jsx","../../images/storage.png","../../../resources/client/components/StoragePopup.jsx","../../../resources/client/drive/shareable-link/shareable-link-page/guest-download-view.jsx"],"sourcesContent":["export default \"__VITE_ASSET__6d4a97f6__\"","import Vector from \"../../../public/images/Vector.png\"\n\n// Helper function to format expiry date and time\nconst formatExpiry = (expiresAt, totalSize) => {\n    const sizeText = totalSize ? formatFileSize(totalSize) : '4.5 KB';\n    \n    if (!expiresAt) {\n        return `${sizeText} - No expiry date`;\n    }\n    \n    try {\n        const expiryDate = new Date(expiresAt);\n        const formattedDate = expiryDate.toLocaleDateString('en-US'); // MM/DD/YYYY format\n        const formattedTime = expiryDate.toLocaleTimeString('en-US', { \n            hour12: false, \n            hour: '2-digit', \n            minute: '2-digit' \n        }); // 24-hour format\n        \n        return `${sizeText} - Expires on ${formattedDate} at ${formattedTime}`;\n    } catch (error) {\n        return `${sizeText} - Invalid expiry date`;\n    }\n};\n\n// Helper function to format file size\nconst formatFileSize = (bytes) => {\n    if (bytes === 0) return '0 B';\n    \n    const k = 1024;\n    const sizes = ['B', 'KB', 'MB', 'GB', 'TB'];\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\n    \n    return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];\n};\n\nexport default function Download({ expiresAt, totalSize, itemCount = 1 }) {\n    return (\n        <div className=\"column-center border-apply p-4\">\n            <img src={Vector} alt=\"\" className=\"h-12 w-12 object-cover\" />\n            <h3 className=\"normal-heading mt-1 \">\n                You received {itemCount} {itemCount === 1 ? 'item' : 'items'}\n            </h3>\n            <p className=\"normal-para mt-1\">{formatExpiry(expiresAt, totalSize)}</p>\n        </div>\n    )\n}\n","export default \"__VITE_ASSET__fb2ce8fe__\"","import { useEffect, useState } from 'react';\nimport { FaCheck } from 'react-icons/fa';\nimport { RiCloseFill } from 'react-icons/ri';\nimport storage from \"../../../public/images/storage.png\"\nconst StoragePopup = ({isOpen}) => {\n    const [Open, setOpen] = useState(false);\n    useEffect(() => {\n        setOpen(isOpen);\n    }, [isOpen]);\n\n    const features = [\n        {\n            title: '20GB of secure, high-quality storage',\n            description: 'No compression. No clutter. Just reliable cloud storage built for your biggest ideas.',\n        },\n        {\n            title: 'Custom share links with full control',\n            description: 'Set passwords, expiration dates, and track every document you share.',\n        },\n        {\n            title: 'PDF-ready. Feedback-ready.',\n            description: 'Fill, sign, edit and comment, all in one place, no tool switching.',\n        },\n    ];\n    return (\n        <>\n            {Open && (\n                <div className=\"fixed inset-0 z-50 flex items-center justify-center p-0 md:p-4 bg-black/50\">\n                    <div className=\"bg-white rounded-none md:rounded-3xl shadow-2xl w-full h-full md:max-w-4xl md:h-auto flex flex-col lg:flex-row overflow-auto\">\n                        {/* Left image section */}\n                        <div className=\"flex-1 flex flex-col relative h-1/3 md:h-auto\">\n                            <button\n                                className=\"absolute top-4 left-4 text-black hover:text-red-500 z-10\"\n                                onClick={() => setOpen(false)}\n                            >\n                                <RiCloseFill size={32} />\n                            </button>\n                            <img\n                                src={storage}\n                                alt=\"A visual representation of cloud storage\"\n                                className=\"w-full h-full object-cover\"\n                            />\n                        </div>\n\n                        {/* Right content section */}\n                        <div className=\"bg-white text-black p-4 md:p-8 flex-1 flex flex-col justify-center space-y-6 overflow-auto\">\n                            <h2 className=\"text-3xl md:text-4xl font-bold mb-3 md:mb-6\">Want to store your content?</h2>\n                            {features.map((item, idx) => (\n                                <div key={idx} className=\"flex items-start space-x-3\">\n                                    <FaCheck className=\"w-6 h-6 text-green-400 mt-1\" />\n                                    <div>\n                                        <h3 className=\"font-semibold text-lg md:text-xl\">{item.title}</h3>\n                                        <p className=\"text-gray-600 mt-1 text-sm md:text-base\">{item.description}</p>\n                                    </div>\n                                </div>\n                            ))}\n                            <a href='https://drime.cloud/' className=\"button-sm md:button-md lg:button-lg w-full md:w-auto !py-3 \">\n                                Get started for free\n                            </a>\n                        </div>\n                    </div>\n                </div>\n            )}\n\n        </>\n    );\n};\n\nexport default StoragePopup;","import React, { useState } from 'react';\nimport { apiClient } from '@common/http/query-client';\nimport { MdClose } from 'react-icons/md';\nimport Download from '@app/components/Download';\nimport FileData from '@app/transfer/components/FileData';\nimport StoragePopup from '@app/components/StoragePopup';\nimport Layout from '@app/components/Layout';\nexport const GuestDownloadView = ({\n  files,\n  totalSize,\n  expiresAt,\n  hash,\n  hasPassword\n}) => {\n  const [password, setPassword] = useState('');\n  const [ispassword, setIspassword] = useState(false)\n\n\n  const handleInputChange = (event) => {\n    setPassword(event.target.value);\n  };\n\n\n  const [isVerifying, setIsVerifying] = useState(false);\n  const [isUnlocked, setIsUnlocked] = useState(!hasPassword);\n  const [passwordError, setPasswordError] = useState('');\n\n  console.log('GuestDownloadView props:', { files, totalSize, expiresAt, hash, hasPassword });\n\n  const handlePasswordSubmit = async (e) => {\n    e.preventDefault();\n    if (!password.trim()) return;\n\n    setIsVerifying(true);\n    setPasswordError('');\n\n    try {\n      const response = await apiClient.post(`guest/upload/${hash}/verify-password`, { password });\n      if (response.data.valid) {\n        setIsUnlocked(true);\n      } else {\n        setPasswordError('Incorrect password. Please try again.');\n      }\n    } catch (error) {\n      setPasswordError('Error verifying password. Please try again.');\n    } finally {\n      setIsVerifying(false);\n    }\n  };\n\n  const handleCreateTransfer = () => {\n    console.log('Create a transfer link clicked!');\n  };\n\n  const [loading, setLoading] = useState(false);\n\n  const [isOpenStorageModal, setIsOpenStorageModal] = useState(false);\n  const handleDownload = () => {\n    if (!hash) {\n      alert(\"Invalid download link.\");\n      return;\n    }\n\n    setLoading(true);\n\n    try {\n      const downloadParams =\n        hasPassword && password ? `?password=${encodeURIComponent(password)}` : \"\";\n      if (files && files.length === 1) {\n        // Single file - direct download using file ID\n        const file = files[0];\n        console.log(\"file\", file)\n        const downloadUrl = `/download/${hash}/${file.id}${downloadParams}`;\n        window.open(downloadUrl, \"_blank\");\n      } else if (files && files.length > 1) {\n        // Multiple files - ZIP download\n        const downloadUrl = `/download/${hash}${downloadParams}`;\n        window.open(downloadUrl, \"_blank\");\n        console.log(\"downloadUrl\", downloadUrl)\n      } else {\n        alert(\"No files available for download.\");\n      }\n    } finally {\n      setLoading(false);\n      setTimeout(() => {\n        setIsOpenStorageModal(true);\n      }, 3000);\n    }\n  };\n\n  // If password protected and not unlocked, show password form\n  if (hasPassword && !isUnlocked) {\n    return (\n      <div className=\"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center p-4 z-50\">\n        <div className=\"box\">\n          {/* Modal Header */}\n          <div className=\"flex justify-between items-center p-4 border-b\">\n            <h3 className=\"text-lg font-bold text-gray-800\">Enter the password</h3>\n            <button onClick={() => setIspassword(false)} className=\"text-gray-400 hover:text-gray-600 transition-colors\">\n              <MdClose className=\"h-6 w-6\" />\n            </button>\n          </div>\n          {/* Modal Body */}\n          <div className=\"p-4\">\n            <p className=\"text-sm text-gray-600 mb-4\">\n              To access this link, you will need its password. If you do not have\n              the password, contact the creator of the link.\n            </p>\n            <input\n              type=\"password\"\n              placeholder=\"Enter the password\"\n              value={password}\n              onChange={handleInputChange}\n              className=\"inut-sm  sm:input\"\n            />\n          </div>\n          {/* Modal Footer */}\n          <div className=\"flex justify-end items-center p-4 space-x-2 border-t\">\n            <button onClick={() => setIspassword(false)} className=\"px-4 py-2 text-white bg-red-600 rounded-lg font-medium hover:bg-red-500 transition-colors\">\n              Cancel\n            </button>\n            <button\n              disabled={isVerifying || !password.trim()}\n              onClick={handlePasswordSubmit}\n              className=\"button-sm md:button-md lg:button-lg \"\n            >\n              {isVerifying ? (\n                <p>\n                  Verifying..\n                </p>\n              ) : (\n                <p>\n                  Access Files\n                </p>\n              )}\n            </button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return <div className=\"space-y-6\">\n    <>\n      <Download \n        expiresAt={expiresAt} \n        totalSize={totalSize} \n        itemCount={files ? files.length : 0}\n      />\n      <div className='!pt-0 p-[5px] lg:p-[30px]'>\n        {/* <div className='maÃ·x-h-[32vh] overflow-y-auto'> */}\n          {/* <div className='pe-[20px]'> */}\n            <FileData \n              step={4} \n              selectedFiles={files} \n              hash={hash} \n              hasPassword={hasPassword} \n              password={password} \n            />\n          {/* </div> */}\n        {/* </div> */}\n        <div className=\"between-align mt-6\">\n          <a href='/' className=\"text-[16px]  text-black font-[600] leading-5 underline\">\n            Create a transfer\n          </a>\n          <button\n            onClick={handleDownload}\n            className=\"button-md \"\n          >\n            Download\n          </button>\n        </div>\n        <StoragePopup isOpen={isOpenStorageModal} />\n      </div>\n    </>\n\n  </div>\n    ;\n};"],"names":["Vector","formatExpiry","expiresAt","totalSize","sizeText","formatFileSize","expiryDate","formattedDate","formattedTime","bytes","k","sizes","i","Download","itemCount","jsxs","jsx","storage","StoragePopup","isOpen","Open","setOpen","useState","useEffect","features","Fragment","RiCloseFill","item","idx","FaCheck","GuestDownloadView","files","hash","hasPassword","password","setPassword","ispassword","setIspassword","handleInputChange","event","isVerifying","setIsVerifying","isUnlocked","setIsUnlocked","passwordError","setPasswordError","handlePasswordSubmit","e","apiClient","loading","setLoading","isOpenStorageModal","setIsOpenStorageModal","handleDownload","downloadParams","file","downloadUrl","MdClose","FileData"],"mappings":"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"}