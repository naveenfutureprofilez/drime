{"version":3,"file":"guest-download-view-26028d1d.js","sources":["../../images/Vector.png","../../../resources/client/components/Download.jsx","../../images/storage.png","../../../resources/client/components/StoragePopup.jsx","../../../resources/client/drive/shareable-link/shareable-link-page/guest-download-view.jsx"],"sourcesContent":["export default \"__VITE_ASSET__6d4a97f6__\"","import Vector from \"../../../public/images/Vector.png\"\n\n// Helper function to format expiry date and time\nconst formatExpiry = (expiresAt, totalSize) => {\n    const sizeText = totalSize ? formatFileSize(totalSize) : '4.5 KB';\n    \n    if (!expiresAt) {\n        return `${sizeText} - No expiry date`;\n    }\n    \n    try {\n        const expiryDate = new Date(expiresAt);\n        const formattedDate = expiryDate.toLocaleDateString('en-US'); // MM/DD/YYYY format\n        const formattedTime = expiryDate.toLocaleTimeString('en-US', { \n            hour12: false, \n            hour: '2-digit', \n            minute: '2-digit' \n        }); // 24-hour format\n        \n        return `${sizeText} - Expires on ${formattedDate} at ${formattedTime}`;\n    } catch (error) {\n        return `${sizeText} - Invalid expiry date`;\n    }\n};\n\n// Helper function to format file size\nconst formatFileSize = (bytes) => {\n    if (bytes === 0) return '0 B';\n    \n    const k = 1024;\n    const sizes = ['B', 'KB', 'MB', 'GB', 'TB'];\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\n    \n    return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];\n};\n\nexport default function Download({ expiresAt, totalSize, itemCount = 1 }) {\n    return (\n        <div className=\"column-center border-apply p-6\">\n            <img src={Vector} alt=\"\" className=\"h-12 w-12 object-cover\" />\n            <h3 className=\"mt-2 font-semibold !text-[18px] mt-1 \">\n                You received {itemCount} {itemCount === 1 ? 'item' : 'items'}\n            </h3>\n            <p className=\"text-gray-500 text-[16px] mt-1\">{formatExpiry(expiresAt, totalSize)}</p>\n        </div>\n    )\n}\n","export default \"__VITE_ASSET__fb2ce8fe__\"","import { useEffect, useState } from 'react';\nimport { FaCheck } from 'react-icons/fa';\nimport { RiCloseFill } from 'react-icons/ri';\nimport storage from \"../../../public/images/storage.png\"\nimport { FigmaCheckIcon } from './FigmaIcons';\nconst StoragePopup = ({isOpen}) => {\n    const [Open, setOpen] = useState(false);\n    useEffect(() => {\n        setOpen(isOpen);\n    }, [isOpen]);\n\n    const features = [\n        {\n            title: '20GB of secure, high-quality storage',\n            description: 'No compression. No clutter. Just reliable cloud storage built for your biggest ideas.',\n        },\n        {\n            title: 'Custom share links with full control',\n            description: 'Set passwords, expiration dates, and track every document you share.',\n        },\n        {\n            title: 'PDF-ready. Feedback-ready.',\n            description: ' Fill, sign, edit and comment,  all in one place, no tool switching.',\n        },\n    ];\n    return (\n        <>\n            {Open && (\n                <div className=\"fixed inset-0 z-50 flex items-center justify-center p-0 md:p-4 bg-black/50\">\n                    <div className=\"bg-white rounded-[20px] shadow-2xl w-full h-full md:max-w-[1100px] md:h-auto flex flex-col lg:flex-row overflow-auto\">\n                        <div className=\"  relative bg-[#bbecff] w-full max-w-[55%]  \">\n                            <button\n                                className=\"absolute top-4 left-4 text-black hover:text-red-500 z-10\"\n                                onClick={() => setOpen(false)}\n                            >\n                                <RiCloseFill size={32} />\n                            </button>\n                            <img\n                                src={storage}\n                                alt=\"A visual representation of cloud storage\"\n                                className=\"w-full h-full object-contain\"\n                            />\n                        </div>\n                        <div className=\"bg-white text-black px-[40px] py-[45px]  justify-center space-y-6 overflow-auto w-full max-w-[45%]\">\n                            <h2 className=\"text-[20px] lg:text-[36px] font-semibold leading-[36px] pb-4  \">Love how this was shared?</h2>\n                            {features.map((item, idx) => (\n                                <div key={idx} className=\"flex items-start space-x-3\">\n                                    <div className='text-3xl mt-2'>\n                                        <FigmaCheckIcon />\n                                    </div>\n                                    <div>\n                                        <h3 className=\"font-semibold text-[15px]\">{item.title}</h3>\n                                        <p className=\"text-gray-600 mt-1 text[12px]\">{item.description}</p>\n                                    </div>\n                                </div>\n                            ))}\n\n                            <div className='pt-[30px]'>\n                                <a href='https://drime.cloud/' className=\"button shadow-none font-normal w-full \">\n                                    Get started for free\n                                </a>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            )}\n        </>\n    );\n};\n\nexport default StoragePopup;","import React, { useState } from 'react';\nimport { apiClient } from '@common/http/query-client';\nimport { MdClose } from 'react-icons/md';\nimport Download from '@app/components/Download';\nimport FileData from '@app/transfer/components/FileData';\nimport StoragePopup from '@app/components/StoragePopup';\nimport Layout from '@app/components/Layout';\nimport { CloseIcon } from '@app/components/FigmaIcons';\nimport { toast } from '@ui/toast/toast';\nimport { Link } from 'react-router';\nexport const GuestDownloadView = ({\n  files,\n  totalSize,\n  expiresAt,\n  hash,\n  hasPassword\n}) => {\n  const [password, setPassword] = useState('');\n  const [ispassword, setIspassword] = useState(false)\n\n\n  const handleInputChange = (event) => {\n    setPassword(event.target.value);\n  };\n\n\n  const [isVerifying, setIsVerifying] = useState(false);\n  const [isUnlocked, setIsUnlocked] = useState(!hasPassword);\n  const [passwordError, setPasswordError] = useState('');\n\n  console.log('GuestDownloadView props:', { files, totalSize, expiresAt, hash, hasPassword });\n\n  const handlePasswordSubmit = async (e) => {\n    e.preventDefault();\n    if (!password.trim()) return;\n\n    setIsVerifying(true);\n    setPasswordError('');\n\n    try {\n      const response = await apiClient.post(`guest/upload/${hash}/verify-password`, { password });\n      if (response.data.valid) {\n        setIsUnlocked(true);\n      } else {\n        setPasswordError('Incorrect password. Please try again.');\n      }\n    } catch (error) {\n      setPasswordError('Error verifying password. Please try again.');\n    } finally {\n      setIsVerifying(false);\n    }\n  };\n\n  const handleCreateTransfer = () => {\n    console.log('Create a transfer link clicked!');\n  };\n\n  const [loading, setLoading] = useState(false);\n\n  const [isOpenStorageModal, setIsOpenStorageModal] = useState(false);\n  const handleDownload = () => {\n    if (!hash) {\n      alert(\"Invalid download link.\");\n      return;\n    }\n    if (hasPassword && !isUnlocked) {\n      return false;\n    }\n\n    setLoading(true);\n\n    try {\n      const downloadParams =\n        hasPassword && password ? `?password=${encodeURIComponent(password)}` : \"\";\n      if (files && files.length === 1) {\n        // Single file - direct download using file ID\n        const file = files[0];\n        console.log(\"file\", file)\n        const downloadUrl = `/download/${hash}/${file.id}${downloadParams}`;\n        window.open(downloadUrl, \"_blank\");\n      } else if (files && files.length > 1) {\n        // Multiple files - ZIP download\n        const downloadUrl = `/download/${hash}${downloadParams}`;\n        window.open(downloadUrl, \"_blank\");\n        console.log(\"downloadUrl\", downloadUrl)\n      } else {\n        alert(\"No files available for download.\");\n      }\n    } finally {\n      setLoading(false);\n      setTimeout(() => {\n        setIsOpenStorageModal(true);\n      }, 3000);\n    }\n  };\n\n  // If password protected and not unlocked, show password form\n  \n\n  return <div className=\"space-y-6 bg-white\">\n    <>\n\n    {(hasPassword && !isUnlocked) ? \n        <div className=\"fixed inset-0 w-full bg-gray-600 bg-opacity-50 flex items-center justify-center  z-50\">\n          <div className=\"box max-w-[500px] border border-gray-500 p-[20px] md:p-[30px]\">  \n            <div className=\"flex justify-between items-center  \">\n              <h3 className=\"text-[18px] font-semibold text-gray-800\">Enter the password </h3>\n              <button onClick={() => setIspassword(false)} className=\"text-gray-400 hover:text-gray-600 transition-colors\">\n                <CloseIcon className=\"h-6 w-6\" />\n              </button>\n            </div>\n              <p className=\"text-[16px] mt-4 text-gray-600 mb-4\">  \n                To access this link, you will need its password. If you do not have the password, contact the creator of the link.\n              </p>\n              <input\n                type=\"password\" autoComplete='off'\n                placeholder=\"Enter the password\"\n                value={password}\n                onChange={handleInputChange}\n                className=\"inut-sm  sm:input\"\n              />\n            <div className=\"flex justify-end items-center p-4 gap-4\">\n              <button onClick={() => setIspassword(false)} className=\"button !bg-transparent !text-black shadow-none hover:shadow-none hover:opacity-[0.5] !p-[12px]\">\n                Cancel\n              </button>\n              <button\n                disabled={isVerifying || !password.trim()}\n                onClick={handlePasswordSubmit}\n                className=\"button font-semibold !p-[12px] !px-[20px] rounded-[14px] min-w-[80px] !shadow-none\" \n              >\n                {isVerifying ? (\n                  <p>\n                    Verifying..\n                  </p>\n                ) : (\n                  <p>\n                    Ok\n                  </p>\n                )}\n              </button>\n            </div>\n          </div>\n        </div> : ''\n    }\n      <Download \n        expiresAt={expiresAt} \n        totalSize={totalSize} \n        itemCount={files ? files.length : 0}\n      />\n      <div className=' mt-0 px-[20px] md:!px-[30px]    '>\n            <FileData \n              step={4} \n              selectedFiles={files} \n              hash={hash}  isLocked={hasPassword && !isUnlocked}\n              hasPassword={hasPassword} \n              password={password} \n            />\n        <div className=\"between-align mt-6 absolute left-0 p-[30px] bottom-0 w-full\">\n          <Link to='/' className=\"text-[16px]  text-black font-[600] leading-5 underline\">\n            Create a transfer\n          </Link>\n          <button\n            onClick={handleDownload}\n            className=\"button-md \">\n            Download\n          </button>\n        </div>\n        <StoragePopup isOpen={isOpenStorageModal} />\n      </div>\n    </>\n\n  </div>\n    ;\n};"],"names":["Vector","formatExpiry","expiresAt","totalSize","sizeText","formatFileSize","expiryDate","formattedDate","formattedTime","bytes","k","sizes","i","Download","itemCount","jsxs","jsx","storage","StoragePopup","isOpen","Open","setOpen","useState","useEffect","features","Fragment","RiCloseFill","item","idx","FigmaCheckIcon","GuestDownloadView","files","hash","hasPassword","password","setPassword","ispassword","setIspassword","handleInputChange","event","isVerifying","setIsVerifying","isUnlocked","setIsUnlocked","passwordError","setPasswordError","handlePasswordSubmit","e","apiClient","loading","setLoading","isOpenStorageModal","setIsOpenStorageModal","handleDownload","downloadParams","file","downloadUrl","CloseIcon","FileData","Link"],"mappings":"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"}